var e=Object.defineProperty,t=(t,a,s)=>(((t,a,s)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s})(t,"symbol"!=typeof a?a+"":a,s),s);import{j as a,b as s,u as l,c as r}from"./query-9fe77bbe.js";import{r as n}from"./vendor-5e66fe52.js";import{L as i}from"./router-d215a13b.js";import{B as o,w as c,z as d,I as m,L as u,p as x,N as h,x as p,A as g,M as b,n as f,u as j,o as y,C as v,c as N,D as w,t as k,h as _,G as D,H as S,f as C,J as A,Q as F,R as q}from"./index-654029b0.js";import{o as T,s as L,e as Q,n as K,b as z,u as O}from"./forms-1427850a.js";import{t as I}from"./zod-7016e973.js";import{T as M}from"./Textarea-cb271d34.js";import{a as E}from"./useClients-84110019.js";import{C as $}from"./ConfirmDialog-287d4948.js";import{B as P}from"./BaseService-e2aecc13.js";import"./supabase-e62705ad.js";import"./icons-9f4f2400.js";const B=T({title:L().min(1,"Title is required").max(100,"Title must be less than 100 characters"),description:L().max(500,"Description must be less than 500 characters").optional(),client_id:L().min(1,"Client is required"),type:Q(["demo","call","meeting","follow_up","consultation"]),status:Q(["scheduled","confirmed","completed","cancelled","rescheduled"]),scheduled_at:L().min(1,"Date and time is required"),duration:K().min(15,"Duration must be at least 15 minutes").max(480,"Duration cannot exceed 8 hours"),location:L().max(200,"Location must be less than 200 characters").optional(),notes:L().max(1e3,"Notes must be less than 1000 characters").optional(),google_calendar_sync:z().optional()});function G({appointment:e,onSave:t,onCancel:s,isLoading:l=!1}){const[r,i]=n.useState(!1),{data:b,isLoading:f}=E(),{register:j,handleSubmit:y,formState:{errors:v},reset:N}=O({resolver:I(B),defaultValues:{title:"",description:"",client_id:"",type:"meeting",status:"scheduled",scheduled_at:"",duration:60,location:"",notes:"",google_calendar_sync:!0}});n.useEffect(()=>{if(e){const t=new Date(e.date_time),a=new Date(t.getTime()-6e4*t.getTimezoneOffset());N({title:e.title||"",description:e.description||"",client_id:e.client_id,type:e.type,status:"no_show"===e.status?"cancelled":e.status,scheduled_at:a.toISOString().slice(0,16),duration:60,location:"",notes:e.notes||"",google_calendar_sync:!1})}},[e,N]);return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:e?"Edit Appointment":"Schedule New Appointment"}),a.jsx(o,{variant:"ghost",size:"sm",onClick:s,className:"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200",children:a.jsx(c,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:y(async e=>{i(!0);try{const a={client_id:e.client_id,date_time:new Date(e.scheduled_at).toISOString(),type:e.type,status:"rescheduled"===e.status?"scheduled":e.status,notes:e.notes||null};await t(a)}catch(a){}finally{i(!1)}}),className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center",children:[a.jsx(d,{className:"w-5 h-5 mr-2"}),"Basic Information"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Title *"}),a.jsx(m,{...j("title"),placeholder:"Enter appointment title",className:v.title?"border-red-500":""}),v.title&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.title.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Client *"}),f?a.jsx("div",{className:"flex items-center justify-center h-10",children:a.jsx(u,{size:"sm"})}):a.jsxs("select",{...j("client_id"),className:"w-full px-3 py-2 border rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-primary-500 "+(v.client_id?"border-red-500":"border-slate-300 dark:border-slate-600"),children:[a.jsx("option",{value:"",children:"Select a client"}),null==b?void 0:b.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]}),v.client_id&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.client_id.message})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Description"}),a.jsx(M,{...j("description"),placeholder:"Brief description of the appointment...",rows:3,className:v.description?"border-red-500":""}),v.description&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.description.message})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center",children:[a.jsx(x,{className:"w-5 h-5 mr-2"}),"Scheduling Details"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[a.jsx(x,{className:"w-4 h-4 inline mr-1"}),"Date & Time *"]}),a.jsx(m,{type:"datetime-local",...j("scheduled_at"),className:v.scheduled_at?"border-red-500":""}),v.scheduled_at&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.scheduled_at.message})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[a.jsx(h,{className:"w-4 h-4 inline mr-1"}),"Duration"]}),a.jsx("select",{...j("duration",{valueAsNumber:!0}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[{value:15,label:"15 minutes"},{value:30,label:"30 minutes"},{value:45,label:"45 minutes"},{value:60,label:"1 hour"},{value:90,label:"1.5 hours"},{value:120,label:"2 hours"},{value:180,label:"3 hours"},{value:240,label:"4 hours"}].map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Type"}),a.jsx("select",{...j("type"),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[{value:"demo",label:"Demo",icon:"ðŸŽ¯"},{value:"call",label:"Phone Call",icon:"ðŸ“ž"},{value:"meeting",label:"Meeting",icon:"ðŸ¤"},{value:"follow_up",label:"Follow-up",icon:"ðŸ”„"},{value:"consultation",label:"Consultation",icon:"ðŸ’¡"}].map(e=>a.jsxs("option",{value:e.value,children:[e.icon," ",e.label]},e.value))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Status"}),a.jsx("select",{...j("status"),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[{value:"scheduled",label:"Scheduled",color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300"},{value:"confirmed",label:"Confirmed",color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300"},{value:"completed",label:"Completed",color:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300"},{value:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300"},{value:"rescheduled",label:"Rescheduled",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300"}].map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:[a.jsx(p,{className:"w-4 h-4 inline mr-1"}),"Location"]}),a.jsx(m,{...j("location"),placeholder:"Meeting location or video call link",className:v.location?"border-red-500":""}),v.location&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.location.message})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 flex items-center",children:[a.jsx(d,{className:"w-5 h-5 mr-2"}),"Additional Information"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Notes"}),a.jsx(M,{...j("notes"),placeholder:"Additional notes or preparation instructions...",rows:4,className:v.notes?"border-red-500":""}),v.notes&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.notes.message})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"google_calendar_sync",...j("google_calendar_sync"),className:"w-4 h-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary focus:ring-2"}),a.jsx("label",{htmlFor:"google_calendar_sync",className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Sync with Google Calendar"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-slate-200 dark:border-slate-700",children:[a.jsx(o,{type:"button",variant:"outline",onClick:s,disabled:r||l,children:"Cancel"}),a.jsxs(o,{type:"submit",disabled:r||l,className:"bg-gradient-to-r from-primary to-primary-600 hover:from-primary-600 hover:to-primary-700",children:[r||l?a.jsx(u,{size:"sm",className:"mr-2"}):a.jsx(g,{className:"w-4 h-4 mr-2"}),e?"Update Appointment":"Schedule Appointment"]})]})]})]})}const R=new class extends P{constructor(){super(...arguments),t(this,"tableName","appointments")}async getAppointments(e,t){try{let a=b.from(this.tableName).select("\n          *,\n          client:clients(id, name, email, phone)\n        ").order("scheduled_at",{ascending:!0});if(e&&(e.status&&(a=a.eq("status",e.status)),e.type&&(a=a.eq("type",e.type)),e.client_id&&(a=a.eq("client_id",e.client_id)),e.date_from&&(a=a.gte("scheduled_at",e.date_from)),e.date_to&&(a=a.lte("scheduled_at",e.date_to)),e.title_search&&(a=a.ilike("title",`%${e.title_search}%`))),t){const{page:e=1,limit:s=10}=t,l=(e-1)*s,r=l+s-1;a=a.range(l,r)}const{data:s,error:l}=await a;return l?{data:null,error:l.message,success:!1}:{data:s||[],error:null,success:!0}}catch(a){return{data:null,error:"Failed to fetch appointments",success:!1}}}async getAppointment(e){try{const{data:t,error:a}=await b.from(this.tableName).select("\n          *,\n          client:clients(id, name, email, phone)\n        ").eq("id",e).single();return a?{data:null,error:a.message,success:!1}:{data:t,error:null,success:!0}}catch(t){return{data:null,error:"Failed to fetch appointment",success:!1}}}async createAppointment(e){try{const{data:t,error:a}=await b.from(this.tableName).insert(e).select().single();return a?{data:null,error:a.message,success:!1}:{data:t,error:null,success:!0}}catch(t){return{data:null,error:"Failed to create appointment",success:!1}}}async updateAppointment(e,t){try{const{data:a,error:s}=await b.from(this.tableName).update({...t,updated_at:(new Date).toISOString()}).eq("id",e).select().single();return s?{data:null,error:s.message,success:!1}:{data:a,error:null,success:!0}}catch(a){return{data:null,error:"Failed to update appointment",success:!1}}}async deleteAppointment(e){try{const{error:t}=await b.from(this.tableName).delete().eq("id",e);return t?{data:null,error:t.message,success:!1}:{data:!0,error:null,success:!0}}catch(t){return{data:null,error:"Failed to delete appointment",success:!1}}}async getAppointmentStats(){try{const{data:e,error:t}=await b.from(this.tableName).select("status, scheduled_at");if(t)return{data:null,error:t.message,success:!1};const a=new Date,s=new Date(a.getFullYear(),a.getMonth(),a.getDate()),l=new Date(s);l.setDate(s.getDate()-s.getDay());const r=new Date(l);r.setDate(l.getDate()+6);return{data:{total:e.length,scheduled:e.filter(e=>"scheduled"===e.status).length,confirmed:e.filter(e=>"confirmed"===e.status).length,completed:e.filter(e=>"completed"===e.status).length,cancelled:e.filter(e=>"cancelled"===e.status).length,rescheduled:e.filter(e=>"rescheduled"===e.status).length,today:e.filter(e=>{const t=new Date(e.scheduled_at);return t>=s&&t<new Date(s.getTime()+864e5)}).length,thisWeek:e.filter(e=>{const t=new Date(e.scheduled_at);return t>=l&&t<=r}).length,overdue:e.filter(e=>new Date(e.scheduled_at)<a&&"completed"!==e.status&&"cancelled"!==e.status).length},error:null,success:!0}}catch(e){return{data:null,error:"Failed to fetch appointment stats",success:!1}}}async getTodaysAppointments(){try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),a=new Date(t.getTime()+864e5),{data:s,error:l}=await b.from(this.tableName).select("\n          *,\n          client:clients(id, name, email, phone)\n        ").gte("scheduled_at",t.toISOString()).lt("scheduled_at",a.toISOString()).order("scheduled_at",{ascending:!0});return l?{data:null,error:l.message,success:!1}:{data:s||[],error:null,success:!0}}catch(e){return{data:null,error:"Failed to fetch today's appointments",success:!1}}}async getUpcomingAppointments(e=5){try{const t=new Date,{data:a,error:s}=await b.from(this.tableName).select("\n          *,\n          client:clients(id, name, email, phone)\n        ").gte("scheduled_at",t.toISOString()).in("status",["scheduled","confirmed"]).order("scheduled_at",{ascending:!0}).limit(e);return s?{data:null,error:s.message,success:!1}:{data:a||[],error:null,success:!0}}catch(t){return{data:null,error:"Failed to fetch upcoming appointments",success:!1}}}async searchAppointments(e){try{const{data:t,error:a}=await b.from(this.tableName).select("\n          *,\n          client:clients(id, name, email, phone)\n        ").or(`title.ilike.%${e}%,description.ilike.%${e}%`).order("scheduled_at",{ascending:!0}).limit(20);return a?{data:null,error:a.message,success:!1}:{data:t||[],error:null,success:!0}}catch(t){return{data:null,error:"Failed to search appointments",success:!1}}}async syncWithGoogleCalendar(e){try{const{error:t}=await b.from(this.tableName).update({google_calendar_id:`gc_${e}_${Date.now()}`,updated_at:(new Date).toISOString()}).eq("id",e);return t?{data:null,error:t.message,success:!1}:{data:!0,error:null,success:!0}}catch(t){return{data:null,error:"Failed to sync with Google Calendar",success:!1}}}subscribeToAppointments(e){return b.channel("appointments_changes").on("postgres_changes",{event:"*",schema:"public",table:"appointments"},e).subscribe()}subscribeToAppointmentStats(e){return b.channel("appointment_stats_changes").on("postgres_changes",{event:"*",schema:"public",table:"appointments"},e).subscribe()}},Y={all:["appointments"],lists:()=>[...Y.all,"list"],list:e=>[...Y.lists(),{filters:e}],details:()=>[...Y.all,"detail"],detail:e=>[...Y.details(),e],stats:()=>[...Y.all,"stats"],today:()=>[...Y.all,"today"],upcoming:e=>[...Y.all,"upcoming",e],search:e=>[...Y.all,"search",e]};const U={scheduled:{label:"Scheduled",color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300",icon:x},confirmed:{label:"Confirmed",color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300",icon:F},completed:{label:"Completed",color:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300",icon:F},cancelled:{label:"Cancelled",color:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",icon:q},no_show:{label:"No Show",color:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",icon:q}},W={demo:{label:"Demo",icon:"ðŸŽ¯",color:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300"},call:{label:"Call",icon:"ðŸ“ž",color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300"},meeting:{label:"Meeting",icon:"ðŸ¤",color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300"},follow_up:{label:"Follow-up",icon:"ðŸ”„",color:"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300"},consultation:{label:"Consultation",icon:"ðŸ’¡",color:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/20 dark:text-indigo-300"}};function V(){const{isAuthenticated:e}=j(),[t,c]=n.useState(""),[d,p]=n.useState("all"),[g,b]=n.useState("all"),[F,q]=n.useState("all"),[T,L]=n.useState(!1),[Q,K]=n.useState(null),[z,O]=n.useState(null),[I,M]=n.useState(!1),{data:E,isLoading:P,error:B}=s({queryKey:Y.list(V),queryFn:()=>R.getAppointments(V),select:e=>e.data||[],staleTime:12e4});var V;const H=function(){const e=l();return r({mutationFn:e=>R.createAppointment(e),onSuccess:t=>{t.data?(e.invalidateQueries({queryKey:Y.lists()}),e.invalidateQueries({queryKey:Y.stats()}),e.invalidateQueries({queryKey:Y.today()}),e.invalidateQueries({queryKey:Y.upcoming(5)}),f.success("Appointment created successfully!")):f.error(t.error||"Failed to create appointment")},onError:e=>{f.error("Failed to create appointment")}})}(),J=function(){const e=l();return r({mutationFn:({id:e,...t})=>R.updateAppointment(e,t),onSuccess:(t,a)=>{t.data?(e.setQueryData(Y.detail(a.id),t.data),e.invalidateQueries({queryKey:Y.lists()}),e.invalidateQueries({queryKey:Y.stats()}),e.invalidateQueries({queryKey:Y.today()}),e.invalidateQueries({queryKey:Y.upcoming(5)}),f.success("Appointment updated successfully!")):f.error(t.error||"Failed to update appointment")},onError:e=>{f.error("Failed to update appointment")}})}(),X=function(){const e=l();return r({mutationFn:e=>R.deleteAppointment(e),onSuccess:(t,a)=>{t.data?(e.removeQueries({queryKey:Y.detail(a)}),e.invalidateQueries({queryKey:Y.lists()}),e.invalidateQueries({queryKey:Y.stats()}),e.invalidateQueries({queryKey:Y.today()}),e.invalidateQueries({queryKey:Y.upcoming(5)}),f.success("Appointment deleted successfully!")):f.error(t.error||"Failed to delete appointment")},onError:e=>{f.error("Failed to delete appointment")}})}(),Z=n.useMemo(()=>E?E.filter(e=>{var a;const s=(e.title||"").toLowerCase().includes(t.toLowerCase())||(e.description||"").toLowerCase().includes(t.toLowerCase())||(null==(a=e.client)?void 0:a.name.toLowerCase().includes(t.toLowerCase())),l="all"===d||e.status===d,r="all"===g||e.type===g;let n=!0;if("all"!==F){const t=new Date(e.date_time),a=new Date,s=new Date(a.getFullYear(),a.getMonth(),a.getDate()),l=new Date(s.getTime()+864e5),r=new Date(s.getTime()+6048e5);switch(F){case"today":n=t>=s&&t<l;break;case"tomorrow":n=t>=l&&t<new Date(l.getTime()+864e5);break;case"this_week":n=t>=s&&t<r;break;case"overdue":n=t<a&&"completed"!==e.status&&"cancelled"!==e.status}}return s&&l&&r&&n}):[],[E,t,d,g,F]);return e?P?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsx(u,{size:"lg",text:"Loading appointments..."})}):B?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-red-600 dark:text-red-400 mb-2",children:"Error Loading Appointments"}),a.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:B.message||"Failed to load appointments. Please try again."})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold gradient-text",children:"Appointments"}),a.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Manage your schedule and client meetings"})]}),a.jsxs(o,{onClick:()=>L(!0),className:"mt-4 sm:mt-0 bg-gradient-to-r from-primary to-primary-600 hover:from-primary-600 hover:to-primary-700 button-glow hover-lift",children:[a.jsx(y,{className:"w-4 h-4 mr-2"}),"Schedule Appointment"]})]}),a.jsx(v,{children:a.jsx(N,{className:"p-6",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),a.jsx(m,{placeholder:"Search appointments by title, description, or client...",value:t,onChange:e=>c(e.target.value),className:"pl-10"})]})}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsxs("select",{value:d,onChange:e=>p(e.target.value),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"scheduled",children:"Scheduled"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"}),a.jsx("option",{value:"rescheduled",children:"Rescheduled"})]}),a.jsxs("select",{value:g,onChange:e=>b(e.target.value),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"demo",children:"Demo"}),a.jsx("option",{value:"call",children:"Call"}),a.jsx("option",{value:"meeting",children:"Meeting"}),a.jsx("option",{value:"follow_up",children:"Follow-up"}),a.jsx("option",{value:"consultation",children:"Consultation"})]}),a.jsxs("select",{value:F,onChange:e=>q(e.target.value),className:"px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"all",children:"All Dates"}),a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"tomorrow",children:"Tomorrow"}),a.jsx("option",{value:"this_week",children:"This Week"}),a.jsx("option",{value:"overdue",children:"Overdue"})]})]})]})})}),0===Z.length?a.jsx(v,{children:a.jsxs(N,{className:"p-12 text-center",children:[a.jsx(x,{className:"w-16 h-16 text-slate-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-slate-900 dark:text-slate-100 mb-2",children:t||"all"!==d||"all"!==g||"all"!==F?"No appointments found":"No appointments scheduled"}),a.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:t||"all"!==d||"all"!==g||"all"!==F?"Try adjusting your search or filter criteria.":"Get started by scheduling your first appointment."}),!t&&"all"===d&&"all"===g&&"all"===F&&a.jsxs(o,{onClick:()=>L(!0),className:"bg-gradient-to-r from-primary to-primary-600 hover:from-primary-600 hover:to-primary-700",children:[a.jsx(y,{className:"w-4 h-4 mr-2"}),"Schedule Your First Appointment"]})]})}):a.jsx("div",{className:"space-y-4",children:Z.map(e=>{var t;const s=U[e.status],l=W[e.type],r=s.icon,n=(c=e.date_time,new Date(c)<new Date);var c;const d=(e=>{const t=new Date(e),a=new Date;return t.toDateString()===a.toDateString()})(e.date_time);return a.jsx(v,{className:"card-hover group",children:a.jsx(N,{className:"p-6",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 group-hover:text-primary transition-colors",children:e.title||"Untitled Appointment"}),a.jsxs(k,{className:`${s.color} text-xs font-medium flex items-center gap-1`,children:[a.jsx(r,{className:"w-3 h-3"}),s.label]}),a.jsxs(k,{className:`${l.color} text-xs font-medium`,children:[l.icon," ",l.label]}),n&&"completed"!==e.status&&"cancelled"!==e.status&&a.jsx(k,{className:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300 text-xs font-medium",children:"Overdue"}),d&&a.jsx(k,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300 text-xs font-medium",children:"Today"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"flex items-center text-sm text-slate-600 dark:text-slate-400",children:[a.jsx(_,{className:"w-4 h-4 mr-2 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:(null==(t=e.client)?void 0:t.name)||"No client assigned"})]}),a.jsxs("div",{className:"flex items-center text-sm text-slate-600 dark:text-slate-400",children:[a.jsx(x,{className:"w-4 h-4 mr-2 flex-shrink-0"}),a.jsx("span",{children:D(e.date_time)})]}),a.jsxs("div",{className:"flex items-center text-sm text-slate-600 dark:text-slate-400",children:[a.jsx(h,{className:"w-4 h-4 mr-2 flex-shrink-0"}),a.jsxs("span",{children:[D(e.date_time)," (60 min)"]})]})]}),e.notes&&a.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400 bg-slate-50 dark:bg-slate-800 p-3 rounded-lg mb-4",children:a.jsx("p",{className:"line-clamp-2",children:e.notes})}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(o,{variant:"outline",size:"sm",onClick:()=>K(e),children:[a.jsx(S,{className:"w-3 h-3 mr-1"}),"Edit"]}),a.jsx(o,{variant:"outline",size:"sm",asChild:!0,children:a.jsxs(i,{to:`/appointments/${e.id}`,children:[a.jsx(C,{className:"w-3 h-3 mr-1"}),"View"]})}),a.jsx(o,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900/20",onClick:()=>(e=>{O(e),M(!0)})(e),children:a.jsx(A,{className:"w-3 h-3"})})]})]})]})})})},e.id)})}),T&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:a.jsx(G,{appointment:null,onSave:async e=>{try{await H.mutateAsync(e),L(!1)}catch(t){}},onCancel:()=>L(!1),isLoading:H.isPending})})}),Q&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:a.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:a.jsx(G,{appointment:Q,onSave:async e=>{if(Q)try{await J.mutateAsync({id:Q.id,...e}),K(null)}catch(t){}},onCancel:()=>K(null),isLoading:J.isPending})})}),a.jsx($,{isOpen:I,onClose:()=>M(!1),onConfirm:async()=>{if(z)try{await X.mutateAsync(z.id),O(null),M(!1)}catch(e){}},title:"Delete Appointment",message:"Are you sure you want to delete this appointment? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",variant:"destructive"})]}):a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mb-2",children:"Authentication Required"}),a.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:"Please sign in to view appointments."}),a.jsx(o,{asChild:!0,children:a.jsx(i,{to:"/auth/login",children:"Sign In"})})]})})}export{V as AppointmentsPage};
